require 'will_paginate/view_helpers/base'
require 'will_paginate/view_helpers/link_renderer'

WillPaginate::ViewHelpers::LinkRenderer.class_eval do
  protected
  def url(page)
    url = @template.request.url
    if page == 1
      url.gsub(/page\/[0-9]+/, '')
    else
      if url =~ /page\/[0-9]+/
        url.gsub(/page\/[0-9]+/, "page/#{page}")
      else
        url + "page/#{page}"
      end
    end
  end
end